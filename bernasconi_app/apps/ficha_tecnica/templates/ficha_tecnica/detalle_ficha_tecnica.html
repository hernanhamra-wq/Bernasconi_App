{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detalle Ficha Técnica</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/buscar_ficha_tecnica.css' %}">
</head>
<body>

<header class="topbar">
    <div class="topbar-left">
        <img src="{% static 'img/logo.png' %}" alt="Logo" class="logo">
    </div>
    <div class="topbar-right">
        <h1>Detalle de Ficha Técnica</h1>
    </div>
</header>

{% if messages %}
  <div style="margin: 12px 0;">
    {% for message in messages %}
      <div class="flash">{{ message }}</div>
    {% endfor %}
  </div>
{% endif %}


<main class="container">

    <section class="results-card">
        <h2>{{ ficha.titulo|default:"Sin título" }}</h2>

        <div style="display:grid; grid-template-columns: 260px 1fr; gap:20px; margin-top:20px;">
            
            <!-- Imagen -->
            <div>
                {% if ficha.imagen %}
                    <img src="{{ ficha.imagen.url }}" style="max-width:100%; border-radius:12px;">
                {% else %}
                    <p class="muted">Sin imagen</p>
                {% endif %}
            </div>

            <!-- Datos principales -->
            <div>
                <p><strong>ID:</strong> {{ ficha.id }}</p>
                <p><strong>N° Ficha:</strong> {{ ficha.n_de_ficha|default:"—" }}</p>
                <p><strong>Inventario:</strong> {{ ficha.inventario|default:"—" }}</p>
                <p><strong>Inventario anterior:</strong> {{ ficha.n_de_inventario_anterior|default:"—" }}</p>
                <p><strong>Año:</strong> {{ ficha.anio|default:"—" }}</p>
                <p><strong>Estado:</strong> {{ ficha.fk_estado|default:"—" }}</p>
                <p><strong>Responsable de carga:</strong> {{ ficha.fk_responsable_carga|default:"—" }}</p>
                <p><strong>Seguimiento:</strong>
                    {% if ficha.seguimiento %} ✅ Sí {% else %} ❌ No {% endif %}
                </p>
                <p><strong>Fecha de carga:</strong> {{ ficha.fecha_de_carga|date:"d/m/Y H:i" }}</p>
            </div>
        </div>

        <hr>

        <h3>Descripción</h3>
        <p>{{ ficha.descripcion|default:"—" }}</p>

        <h3>Observaciones</h3>
        <p>{{ ficha.observacion|default:"—" }}</p>

        <h3>Dimensiones</h3>
        <ul>
            <li><strong>Dimensiones (texto):</strong> {{ ficha.dimensiones|default:"—" }}</li>
            <li><strong>Ancho:</strong> {{ ficha.ancho|default:"—" }}</li>
            <li><strong>Alto:</strong> {{ ficha.alto|default:"—" }}</li>
            <li><strong>Diámetro:</strong> {{ ficha.diametro|default:"—" }}</li>
            <li><strong>Profundidad:</strong> {{ ficha.profundidad|default:"—" }}</li>
        </ul>

        <h3>Materiales</h3>
        <p>
            {% for rel in ficha.materiales_relacion.all %}
                {{ rel.material.nombre }}
                {% if rel.detalle %} ({{ rel.detalle }}){% endif %}
                {% if not forloop.last %}, {% endif %}
            {% empty %}
                — 
            {% endfor %}
        </p>

        <div style="margin-top:30px; display:flex; gap:10px;">
            <a class="btn primary" href="{% url 'ficha_tecnica:editar_ficha_tecnica' ficha.pk %}">Editar</a>
            <a class="btn ghost" href="{% url 'ficha_tecnica:buscar_ficha_tecnica' %}">Volver a búsqueda</a>
            <a class="btn ghost" href="{% url 'ficha_tecnica:ficha_tecnica_list' %}">Listado</a>
        </div>
    </section>

</main>
</body>
</html>
